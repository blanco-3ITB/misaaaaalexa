{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import api from'../utils/api';import'./Messenger.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MessengerRoutes=()=>{const[deliveries,setDeliveries]=useState([]);const[stats,setStats]=useState(null);const[loading,setLoading]=useState(true);const[filter,setFilter]=useState('all');const[failureModal,setFailureModal]=useState({visible:false,deliveryId:null});const[failureReason,setFailureReason]=useState('');const[assignedRoute,setAssignedRoute]=useState(null);// Proof capture refs/state\nconst videoRef=useRef(null);const canvasRef=useRef(null);const fileInputRef=useRef(null);const[useCamera,setUseCamera]=useState(false);const[uploadedProof,setUploadedProof]=useState(null);const[proofModal,setProofModal]=useState({visible:false,deliveryId:null});useEffect(()=>{fetchRoutes();// Auto-refresh every 30 seconds (FR-M12: route update notifications)\nconst interval=setInterval(fetchRoutes,30000);return()=>clearInterval(interval);},[]);const fetchRoutes=async()=>{try{setLoading(true);const response=await api.get('/messenger/routes');const rawDeliveries=response.data.deliveries;// Extract route info (FR-M03: assigned route for the day)\nconst routes=[...new Set(rawDeliveries.map(d=>{var _d$billId;return(_d$billId=d.billId)===null||_d$billId===void 0?void 0:_d$billId.route;}).filter(Boolean))];setAssignedRoute(routes.length===1?routes[0]:\"Multiple Routes (\".concat(routes.length,\")\"));// Sort by sequence/address for optimization (FR-M04: optimized delivery sequence)\nconst optimizedDeliveries=sortDeliveries(rawDeliveries);setDeliveries(optimizedDeliveries);setStats(response.data.stats);}catch(error){console.error('Error fetching routes:',error);}finally{setLoading(false);}};// Simple optimization: group by route, then sort by pending status first, then address\nconst sortDeliveries=items=>{return items.sort((a,b)=>{var _a$billId,_b$billId;const statusOrder={pending:0,assigned:1,delivered:2,failed:3};const statusDiff=(statusOrder[a.status]||0)-(statusOrder[b.status]||0);if(statusDiff!==0)return statusDiff;const addrA=((_a$billId=a.billId)===null||_a$billId===void 0?void 0:_a$billId.address)||'';const addrB=((_b$billId=b.billId)===null||_b$billId===void 0?void 0:_b$billId.address)||'';return addrA.localeCompare(addrB);});};const filteredDeliveries=filter==='all'?deliveries:deliveries.filter(d=>d.status===filter);const handleStatusUpdate=async function(deliveryId,newStatus){let reason=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';try{await api.put(\"/messenger/deliveries/\".concat(deliveryId,\"/status\"),{status:newStatus,failureReason:reason,notes:reason});fetchRoutes();}catch(error){console.error('Error updating status:',error);alert('Error updating delivery status');}};const openFailureModal=deliveryId=>{setFailureModal({visible:true,deliveryId});setFailureReason('');};const submitFailure=()=>{if(!failureReason.trim()){alert('Please enter a failure reason');return;}handleStatusUpdate(failureModal.deliveryId,'failed',failureReason);setFailureModal({visible:false,deliveryId:null});setFailureReason('');};// Proof modal helpers: require proof before marking delivered\nconst openProofModal=deliveryId=>{setProofModal({visible:true,deliveryId});setUploadedProof(null);setUseCamera(false);};const startCamera=async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});if(videoRef.current){videoRef.current.srcObject=stream;setUseCamera(true);}}catch(error){alert('Could not access camera: '+error.message);}};const capturePhoto=()=>{if(videoRef.current&&canvasRef.current){const context=canvasRef.current.getContext('2d');canvasRef.current.width=videoRef.current.videoWidth||640;canvasRef.current.height=videoRef.current.videoHeight||480;context.drawImage(videoRef.current,0,0,canvasRef.current.width,canvasRef.current.height);const imageData=canvasRef.current.toDataURL('image/jpeg');setUploadedProof(imageData);setUseCamera(false);if(videoRef.current.srcObject){videoRef.current.srcObject.getTracks().forEach(track=>track.stop());}}};const handleProofFile=e=>{const file=e.target.files[0];if(file){const reader=new FileReader();reader.onload=event=>setUploadedProof(event.target.result);reader.readAsDataURL(file);}};const handleUploadProof=async()=>{if(!proofModal.deliveryId||!uploadedProof){alert('Please capture or upload a photo first');return;}try{await api.post(\"/messenger/deliveries/\".concat(proofModal.deliveryId,\"/proof\"),{imageData:uploadedProof});alert('Proof uploaded and delivery marked as delivered');setProofModal({visible:false,deliveryId:null});setUploadedProof(null);fetchRoutes();}catch(error){console.error('Error uploading proof:',error);alert('Error uploading proof');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading your routes...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"messenger-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Routes & Tasks\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Track your daily deliveries and update status\"})]}),assignedRoute&&/*#__PURE__*/_jsxs(\"div\",{className:\"route-summary-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"route-label\",children:\"Assigned Route:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"route-value\",children:assignedRoute}),/*#__PURE__*/_jsx(\"button\",{className:\"refresh-btn\",onClick:fetchRoutes,title:\"Refresh for updates\",children:\"\\u21BB Refresh\"})]}),stats&&/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:stats.total}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Tasks\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-box success\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:stats.delivered}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Delivered\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-box warning\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:stats.pending}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Pending\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-box danger\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-number\",children:stats.failed}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Failed\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(filter==='all'?'active':''),onClick:()=>setFilter('all'),children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(filter==='pending'?'active':''),onClick:()=>setFilter('pending'),children:\"Pending\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(filter==='delivered'?'active':''),onClick:()=>setFilter('delivered'),children:\"Delivered\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(filter==='failed'?'active':''),onClick:()=>setFilter('failed'),children:\"Failed\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sequence-note\",children:\"Deliveries are optimized by status and address sequence\"}),/*#__PURE__*/_jsx(\"div\",{className:\"deliveries-list\",children:filteredDeliveries.map(delivery=>{var _delivery$billId,_delivery$billId2,_delivery$billId3,_delivery$billId4,_delivery$billId5;return/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:((_delivery$billId=delivery.billId)===null||_delivery$billId===void 0?void 0:_delivery$billId.customerName)||'Unknown Customer'}),/*#__PURE__*/_jsxs(\"p\",{className:\"delivery-account\",children:[\"Account: \",(_delivery$billId2=delivery.billId)===null||_delivery$billId2===void 0?void 0:_delivery$billId2.accountNumber]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-\".concat(delivery.status),children:delivery.status.toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Address:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_delivery$billId3=delivery.billId)===null||_delivery$billId3===void 0?void 0:_delivery$billId3.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Route:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(_delivery$billId4=delivery.billId)===null||_delivery$billId4===void 0?void 0:_delivery$billId4.route})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83D\\uDCC4 Bill Type:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:((_delivery$billId5=delivery.billId)===null||_delivery$billId5===void 0?void 0:_delivery$billId5.billType)==='disconnection_notice'?'Disconnection Notice':'Regular Bill'})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delivery-actions\",children:delivery.status==='pending'||delivery.status==='assigned'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn success\",onClick:()=>openProofModal(delivery._id),children:\"Mark Delivered\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn warning\",onClick:()=>openFailureModal(delivery._id),children:\"Mark Failed\"})]}):/*#__PURE__*/_jsx(\"span\",{className:\"completed-badge\",children:delivery.status==='delivered'?'Completed':'Failed'})}),delivery.failureReason&&/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-failure-reason\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Reason:\"}),\" \",delivery.failureReason]})]},delivery._id);})}),filteredDeliveries.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"No \",filter!=='all'?filter:'',\" deliveries at the moment.\"]})}),proofModal.visible&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setProofModal({visible:false,deliveryId:null}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upload Proof of Delivery\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Capture or upload photo evidence before marking delivered.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-options\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"upload-btn camera\",onClick:startCamera,children:\"Use Camera\"}),/*#__PURE__*/_jsx(\"button\",{className:\"upload-btn gallery\",onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},children:\"Upload from Gallery\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,accept:\"image/*\",style:{display:'none'},onChange:handleProofFile}),useCamera&&/*#__PURE__*/_jsxs(\"div\",{className:\"camera-section\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{className:\"capture-btn\",onClick:capturePhoto,children:\"\\uD83D\\uDCF8 Capture\"})]}),uploadedProof&&/*#__PURE__*/_jsx(\"div\",{className:\"image-preview\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadedProof,alt:\"Proof\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>setProofModal({visible:false,deliveryId:null}),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleUploadProof,children:\"Upload & Mark Delivered\"})]})]})}),failureModal.visible&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setFailureModal({visible:false,deliveryId:null}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Mark Delivery as Failed\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please provide the reason for failure:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:failureReason,onChange:e=>setFailureReason(e.target.value),placeholder:\"Enter reason (e.g., Customer not home, Address not found, etc.)\",className:\"failure-textarea\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>setFailureModal({visible:false,deliveryId:null}),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:submitFailure,children:\"Confirm Failed\"})]})]})})]});};export default MessengerRoutes;","map":{"version":3,"names":["React","useState","useEffect","useRef","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MessengerRoutes","deliveries","setDeliveries","stats","setStats","loading","setLoading","filter","setFilter","failureModal","setFailureModal","visible","deliveryId","failureReason","setFailureReason","assignedRoute","setAssignedRoute","videoRef","canvasRef","fileInputRef","useCamera","setUseCamera","uploadedProof","setUploadedProof","proofModal","setProofModal","fetchRoutes","interval","setInterval","clearInterval","response","get","rawDeliveries","data","routes","Set","map","d","_d$billId","billId","route","Boolean","length","concat","optimizedDeliveries","sortDeliveries","error","console","items","sort","a","b","_a$billId","_b$billId","statusOrder","pending","assigned","delivered","failed","statusDiff","status","addrA","address","addrB","localeCompare","filteredDeliveries","handleStatusUpdate","newStatus","reason","arguments","undefined","put","notes","alert","openFailureModal","submitFailure","trim","openProofModal","startCamera","stream","navigator","mediaDevices","getUserMedia","video","facingMode","current","srcObject","message","capturePhoto","context","getContext","width","videoWidth","height","videoHeight","drawImage","imageData","toDataURL","getTracks","forEach","track","stop","handleProofFile","e","file","target","files","reader","FileReader","onload","event","result","readAsDataURL","handleUploadProof","post","className","children","onClick","title","total","delivery","_delivery$billId","_delivery$billId2","_delivery$billId3","_delivery$billId4","_delivery$billId5","customerName","accountNumber","toUpperCase","billType","_id","stopPropagation","_fileInputRef$current","click","type","ref","accept","style","display","onChange","autoPlay","playsInline","src","alt","value","placeholder"],"sources":["C:/pod system/frontend/src/pages/MessengerRoutes.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport api from '../utils/api';\r\nimport './Messenger.css';\r\n\r\nconst MessengerRoutes = () => {\r\n  const [deliveries, setDeliveries] = useState([]);\r\n  const [stats, setStats] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState('all');\r\n  const [failureModal, setFailureModal] = useState({ visible: false, deliveryId: null });\r\n  const [failureReason, setFailureReason] = useState('');\r\n  const [assignedRoute, setAssignedRoute] = useState(null);\r\n  // Proof capture refs/state\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n  const [useCamera, setUseCamera] = useState(false);\r\n  const [uploadedProof, setUploadedProof] = useState(null);\r\n  const [proofModal, setProofModal] = useState({ visible: false, deliveryId: null });\r\n\r\n  useEffect(() => {\r\n    fetchRoutes();\r\n    // Auto-refresh every 30 seconds (FR-M12: route update notifications)\r\n    const interval = setInterval(fetchRoutes, 30000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const fetchRoutes = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get('/messenger/routes');\r\n      const rawDeliveries = response.data.deliveries;\r\n      \r\n      // Extract route info (FR-M03: assigned route for the day)\r\n      const routes = [...new Set(rawDeliveries.map(d => d.billId?.route).filter(Boolean))];\r\n      setAssignedRoute(routes.length === 1 ? routes[0] : `Multiple Routes (${routes.length})`);\r\n      \r\n      // Sort by sequence/address for optimization (FR-M04: optimized delivery sequence)\r\n      const optimizedDeliveries = sortDeliveries(rawDeliveries);\r\n      setDeliveries(optimizedDeliveries);\r\n      setStats(response.data.stats);\r\n    } catch (error) {\r\n      console.error('Error fetching routes:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Simple optimization: group by route, then sort by pending status first, then address\r\n  const sortDeliveries = (items) => {\r\n    return items.sort((a, b) => {\r\n      const statusOrder = { pending: 0, assigned: 1, delivered: 2, failed: 3 };\r\n      const statusDiff = (statusOrder[a.status] || 0) - (statusOrder[b.status] || 0);\r\n      if (statusDiff !== 0) return statusDiff;\r\n      \r\n      const addrA = a.billId?.address || '';\r\n      const addrB = b.billId?.address || '';\r\n      return addrA.localeCompare(addrB);\r\n    });\r\n  };\r\n\r\n  const filteredDeliveries = filter === 'all' \r\n    ? deliveries \r\n    : deliveries.filter(d => d.status === filter);\r\n\r\n  const handleStatusUpdate = async (deliveryId, newStatus, reason = '') => {\r\n    try {\r\n      await api.put(`/messenger/deliveries/${deliveryId}/status`, {\r\n        status: newStatus,\r\n        failureReason: reason,\r\n        notes: reason,\r\n      });\r\n      fetchRoutes();\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n      alert('Error updating delivery status');\r\n    }\r\n  };\r\n\r\n  const openFailureModal = (deliveryId) => {\r\n    setFailureModal({ visible: true, deliveryId });\r\n    setFailureReason('');\r\n  };\r\n\r\n  const submitFailure = () => {\r\n    if (!failureReason.trim()) {\r\n      alert('Please enter a failure reason');\r\n      return;\r\n    }\r\n    handleStatusUpdate(failureModal.deliveryId, 'failed', failureReason);\r\n    setFailureModal({ visible: false, deliveryId: null });\r\n    setFailureReason('');\r\n  };\r\n\r\n  // Proof modal helpers: require proof before marking delivered\r\n  const openProofModal = (deliveryId) => {\r\n    setProofModal({ visible: true, deliveryId });\r\n    setUploadedProof(null);\r\n    setUseCamera(false);\r\n  };\r\n\r\n  const startCamera = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        setUseCamera(true);\r\n      }\r\n    } catch (error) {\r\n      alert('Could not access camera: ' + error.message);\r\n    }\r\n  };\r\n\r\n  const capturePhoto = () => {\r\n    if (videoRef.current && canvasRef.current) {\r\n      const context = canvasRef.current.getContext('2d');\r\n      canvasRef.current.width = videoRef.current.videoWidth || 640;\r\n      canvasRef.current.height = videoRef.current.videoHeight || 480;\r\n      context.drawImage(videoRef.current, 0, 0, canvasRef.current.width, canvasRef.current.height);\r\n      const imageData = canvasRef.current.toDataURL('image/jpeg');\r\n      setUploadedProof(imageData);\r\n      setUseCamera(false);\r\n      if (videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleProofFile = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.onload = (event) => setUploadedProof(event.target.result);\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const handleUploadProof = async () => {\r\n    if (!proofModal.deliveryId || !uploadedProof) {\r\n      alert('Please capture or upload a photo first');\r\n      return;\r\n    }\r\n    try {\r\n      await api.post(`/messenger/deliveries/${proofModal.deliveryId}/proof`, { imageData: uploadedProof });\r\n      alert('Proof uploaded and delivery marked as delivered');\r\n      setProofModal({ visible: false, deliveryId: null });\r\n      setUploadedProof(null);\r\n      fetchRoutes();\r\n    } catch (error) {\r\n      console.error('Error uploading proof:', error);\r\n      alert('Error uploading proof');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading your routes...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"messenger-container\">\r\n      <div className=\"page-header\">\r\n        <h1>My Routes & Tasks</h1>\r\n        <p>Track your daily deliveries and update status</p>\r\n      </div>\r\n\r\n      {/* Route Summary (FR-M03) */}\r\n      {assignedRoute && (\r\n        <div className=\"route-summary-box\">\r\n          <div className=\"route-label\">Assigned Route:</div>\r\n          <div className=\"route-value\">{assignedRoute}</div>\r\n          <button className=\"refresh-btn\" onClick={fetchRoutes} title=\"Refresh for updates\">\r\n            â†» Refresh\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {stats && (\r\n        <div className=\"stats-grid\">\r\n          <div className=\"stat-box\">\r\n            <div className=\"stat-number\">{stats.total}</div>\r\n            <div className=\"stat-label\">Total Tasks</div>\r\n          </div>\r\n          <div className=\"stat-box success\">\r\n            <div className=\"stat-number\">{stats.delivered}</div>\r\n            <div className=\"stat-label\">Delivered</div>\r\n          </div>\r\n          <div className=\"stat-box warning\">\r\n            <div className=\"stat-number\">{stats.pending}</div>\r\n            <div className=\"stat-label\">Pending</div>\r\n          </div>\r\n          <div className=\"stat-box danger\">\r\n            <div className=\"stat-number\">{stats.failed}</div>\r\n            <div className=\"stat-label\">Failed</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"filter-section\">\r\n        <button \r\n          className={`filter-btn ${filter === 'all' ? 'active' : ''}`}\r\n          onClick={() => setFilter('all')}\r\n        >\r\n          All\r\n        </button>\r\n        <button \r\n          className={`filter-btn ${filter === 'pending' ? 'active' : ''}`}\r\n          onClick={() => setFilter('pending')}\r\n        >\r\n          Pending\r\n        </button>\r\n        <button \r\n          className={`filter-btn ${filter === 'delivered' ? 'active' : ''}`}\r\n          onClick={() => setFilter('delivered')}\r\n        >\r\n          Delivered\r\n        </button>\r\n        <button \r\n          className={`filter-btn ${filter === 'failed' ? 'active' : ''}`}\r\n          onClick={() => setFilter('failed')}\r\n        >\r\n          Failed\r\n        </button>\r\n      </div>\r\n\r\n      {/* Delivery Sequence (FR-M04: optimized sequence shown in order) */}\r\n      <div className=\"sequence-note\">\r\n        Deliveries are optimized by status and address sequence\r\n      </div>\r\n\r\n      <div className=\"deliveries-list\">\r\n        {filteredDeliveries.map((delivery) => (\r\n          <div key={delivery._id} className=\"delivery-card\">\r\n            <div className=\"delivery-header\">\r\n              <div>\r\n                <h3>{delivery.billId?.customerName || 'Unknown Customer'}</h3>\r\n                <p className=\"delivery-account\">Account: {delivery.billId?.accountNumber}</p>\r\n              </div>\r\n              <span className={`status-badge status-${delivery.status}`}>\r\n                {delivery.status.toUpperCase()}\r\n              </span>\r\n            </div>\r\n\r\n            <div className=\"delivery-details\">\r\n              <div className=\"detail-row\">\r\n                <span className=\"label\">Address:</span>\r\n                <span className=\"value\">{delivery.billId?.address}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"label\">Route:</span>\r\n                <span className=\"value\">{delivery.billId?.route}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"label\">ðŸ“„ Bill Type:</span>\r\n                <span className=\"value\">{delivery.billId?.billType === 'disconnection_notice' ? 'Disconnection Notice' : 'Regular Bill'}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"delivery-actions\">\r\n              {delivery.status === 'pending' || delivery.status === 'assigned' ? (\r\n                <>\r\n                  <button \r\n                    className=\"action-btn success\"\r\n                    onClick={() => openProofModal(delivery._id)}\r\n                  >\r\n                    Mark Delivered\r\n                  </button>\r\n                  <button \r\n                    className=\"action-btn warning\"\r\n                    onClick={() => openFailureModal(delivery._id)}\r\n                  >\r\n                    Mark Failed\r\n                  </button>\r\n                </>\r\n              ) : (\r\n                <span className=\"completed-badge\">\r\n                  {delivery.status === 'delivered' ? 'Completed' : 'Failed'}\r\n                </span>\r\n              )}\r\n            </div>\r\n            {delivery.failureReason && (\r\n              <div className=\"delivery-failure-reason\">\r\n                <strong>Reason:</strong> {delivery.failureReason}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {filteredDeliveries.length === 0 && (\r\n        <div className=\"empty-state\">\r\n          <p>No {filter !== 'all' ? filter : ''} deliveries at the moment.</p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Proof Upload Modal (require proof before marking delivered) */}\r\n      {proofModal.visible && (\r\n        <div className=\"modal-overlay\" onClick={() => setProofModal({ visible: false, deliveryId: null })}>\r\n          <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n            <h2>Upload Proof of Delivery</h2>\r\n            <p>Capture or upload photo evidence before marking delivered.</p>\r\n\r\n            <div className=\"upload-options\">\r\n              <button className=\"upload-btn camera\" onClick={startCamera}>Use Camera</button>\r\n              <button className=\"upload-btn gallery\" onClick={() => fileInputRef.current?.click()}>Upload from Gallery</button>\r\n            </div>\r\n\r\n            <input type=\"file\" ref={fileInputRef} accept=\"image/*\" style={{ display: 'none' }} onChange={handleProofFile} />\r\n\r\n            {useCamera && (\r\n              <div className=\"camera-section\">\r\n                <video ref={videoRef} autoPlay playsInline></video>\r\n                <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>\r\n                <button className=\"capture-btn\" onClick={capturePhoto}>ðŸ“¸ Capture</button>\r\n              </div>\r\n            )}\r\n\r\n            {uploadedProof && (\r\n              <div className=\"image-preview\">\r\n                <img src={uploadedProof} alt=\"Proof\" />\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"modal-buttons\">\r\n              <button className=\"btn btn-secondary\" onClick={() => setProofModal({ visible: false, deliveryId: null })}>Cancel</button>\r\n              <button className=\"btn btn-danger\" onClick={handleUploadProof}>Upload & Mark Delivered</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Failure Reason Modal (FR-M07: require reason for failed delivery) */}\r\n      {failureModal.visible && (\r\n        <div className=\"modal-overlay\" onClick={() => setFailureModal({ visible: false, deliveryId: null })}>\r\n          <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n            <h2>Mark Delivery as Failed</h2>\r\n            <p>Please provide the reason for failure:</p>\r\n            <textarea\r\n              value={failureReason}\r\n              onChange={(e) => setFailureReason(e.target.value)}\r\n              placeholder=\"Enter reason (e.g., Customer not home, Address not found, etc.)\"\r\n              className=\"failure-textarea\"\r\n            />\r\n            <div className=\"modal-buttons\">\r\n              <button \r\n                className=\"btn btn-secondary\"\r\n                onClick={() => setFailureModal({ visible: false, deliveryId: null })}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button \r\n                className=\"btn btn-danger\"\r\n                onClick={submitFailure}\r\n              >\r\n                Confirm Failed\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessengerRoutes;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}